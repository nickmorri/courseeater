<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>CourseEater - Login</title>
    
    <!-- Services -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
    	body {
			background: url('background.jpg');
			-webkit-background-size: cover;
			-moz-background-size: cover;
			-o-background-size: cover;
			background-size: cover;  
		}
		.jumbotron {
			background-color: rgba(255, 255, 255, 0.9);	
		}
    </style>
    
    <script>
    
    	Parse.initialize("ZJuxK6cPbOs5u3hy78QuIIojsBLnrDgpPeY9EQNU", "Rncx0sNYiCARajhzNE2m86l4HXdmYxo3yZ2AGJNy");
	    if (Parse.User.current()) {window.location.replace("track.html");}
	    
    	$(document).ready(function() {
	    	
		  	$("#alert-login").hide();
		  	
		  	// Login processing
		  	$("#loginForm").submit(function() {
			  	event.preventDefault();
			  	Parse.User.logIn($(".form-control-username").val(), $(".form-control-password").val(), {
					success: function(user) {
						window.location.replace("track.html");
					},
					error: function(user, error) {
						if (error.code == 101) {
							console.log(error);
							$("#alert-login").show();
							$("#loginForm").trigger("reset");
							$("#loginForm .form-control-username").focus();
						}
					}	
				});
			});
			
			$("#password-reset").click(function() {
				Parse.User.requestPasswordReset(Parse.User.get("email"), {
					success: function() {
						$("#alert-login-message").text("Please check your email for password reset instructions");
					},
					error: function(error) {
						// Show the error message somewhere
						alert("Error: " + error.code + " " + error.message);
					}
				});
			});
		});
    </script>
</head>
<body>

  <header class="navbar navbar-static-top" role="banner">
      <nav class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="#">CourseEater</a>
          </div>
        </div>
      </nav>
  </header>
  
  <div class="container form-user-management">
    <div class="jumbotron">
      
      <form role="form" id="loginForm">
        <h3>Login</h3>
        <input class="form-control form-control-username" type="text" placeholder="Enter username" required autofocus />
        <input class="form-control form-control-password" type="password" placeholder="Enter password" autocomplete="off" required/>
        <button type="submit" class="btn btn-lg btn-primary btn-block">Login</button>
      </form>
      
      <div id="alert-login" class="alert alert-danger">
		  <span id="alert-login-message"><strong>Whoops!</strong> Either your username or password were incorrect. Please try again or <a href="passwordreset.html">try resetting your password.</a></span>
	  </div>

    </div>
  </div>
  
  <div class="container form-user-management">
  	<div class="jumbotron">
  		<h3>Create new account</h3>
  		<a href="registration.html"><button class="btn btn-lg btn-primary btn-block">Register</button></a>
  	</div>
  </div>

  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
</body>
</html>